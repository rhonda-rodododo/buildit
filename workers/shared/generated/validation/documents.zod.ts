/**
 * @generated from protocol/schemas/modules/documents/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Documents module
 */

import { z } from "zod";

export const AttachmentSchema = z.object({
  type: z.enum(["image", "file", "link"]),
  url: z.string().url().max(2048),
  name: z.string().max(256).optional(),
  mimeType: z.string().optional(),
  /** File size in bytes */
  size: z.number().int().optional(),
});
export type Attachment = z.infer<typeof AttachmentSchema>;

/** A document with content and metadata */
export const DocumentSchema = z
  .object({
    /** Schema version that created this content */
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    /** Unique document identifier */
    id: z.string().uuid(),
    /** Document title */
    title: z.string().max(512),
    /** Document content (format depends on type) */
    content: z.string().max(1048576),
    /** Document content type */
    type: z.enum(["markdown", "plain_text", "rich_text"]),
    /** Optional summary or excerpt */
    summary: z.string().max(1024).optional(),
    /** Who can view this document */
    visibility: z.enum(["private", "group", "public"]).default("group"),
    /** Who can edit this document */
    editPermission: z
      .enum(["owner", "editors", "group", "public"])
      .default("owner"),
    /** Associated group ID */
    groupId: z.string().optional(),
    /** Parent document for hierarchical organization */
    parentId: z.string().uuid().optional(),
    /** Document tags for categorization */
    tags: z.array(z.string().max(64)).max(20).optional(),
    attachments: z.array(AttachmentSchema).max(50).optional(),
    /** Pubkeys of users with edit permission */
    editors: z.array(z.string().regex(new RegExp("^[0-9a-f]{64}$"))).optional(),
    /** Signal-style encrypted link previews for URLs in document */
    linkPreviews: z.array(z.unknown()).max(10).optional(),
    /** Document revision version */
    version: z.number().int().gte(1).default(1),
    /** Creator's public key (hex) */
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** Creation timestamp (Unix seconds) */
    createdAt: z.number().int(),
    /** Last update timestamp (Unix seconds) */
    updatedAt: z.number().int().optional(),
    /** Last editor's public key */
    updatedBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
  })
  .passthrough();
export type Document = z.infer<typeof DocumentSchema>;

/** A revision history entry for a document */
export const DocumentRevisionSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    documentId: z.string().uuid(),
    version: z.number().int().gte(1),
    content: z.string().max(1048576),
    /** Description of changes in this revision */
    changeNote: z.string().max(500).optional(),
    editedBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    editedAt: z.number().int(),
  })
  .passthrough();
export type DocumentRevision = z.infer<typeof DocumentRevisionSchema>;

/** Module version */
export const DOCUMENTS_SCHEMA_VERSION = "1.0.0" as const;
