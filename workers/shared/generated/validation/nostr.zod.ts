/**
 * @generated from protocol/schemas/modules/nostr/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Nostr module
 */

import { z } from "zod";

/** A signed Nostr event (NIP-01) */
export const NostrEventSchema = z
  .object({
    /** Schema version */
    _v: z.string().default("1.0.0"),
    /** 32-byte lowercase hex event ID */
    id: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** 32-byte lowercase hex public key */
    pubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** Unix timestamp in seconds */
    created_at: z.number().int(),
    /** Event kind number */
    kind: z.number().int(),
    /** Array of tag arrays */
    tags: z.array(z.array(z.string())),
    /** Event content (may be encrypted) */
    content: z.string(),
    /** 64-byte lowercase hex Schnorr signature */
    sig: z.string().regex(new RegExp("^[0-9a-f]{128}$")),
  })
  .passthrough();
export type NostrEvent = z.infer<typeof NostrEventSchema>;

/** An unsigned Nostr event (before signing) */
export const UnsignedEventSchema = z
  .object({
    /** Schema version */
    _v: z.string().default("1.0.0"),
    /** 32-byte lowercase hex public key */
    pubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** Unix timestamp in seconds */
    created_at: z.number().int(),
    /** Event kind number */
    kind: z.number().int(),
    /** Array of tag arrays */
    tags: z.array(z.array(z.string())),
    /** Event content */
    content: z.string(),
  })
  .passthrough();
export type UnsignedEvent = z.infer<typeof UnsignedEventSchema>;

/** Nostr subscription filter (NIP-01) */
export const NostrFilterSchema = z
  .object({
    /** Schema version */
    _v: z.string().default("1.0.0"),
    /** Event IDs to match */
    ids: z.array(z.string()).optional(),
    /** Author pubkeys to match */
    authors: z.array(z.string()).optional(),
    /** Event kinds to match */
    kinds: z.array(z.number().int()).optional(),
    /** Events after this Unix timestamp */
    since: z.number().int().optional(),
    /** Events before this Unix timestamp */
    until: z.number().int().optional(),
    /** Maximum number of events to return */
    limit: z.number().int().optional(),
    /** Full-text search query (NIP-50) */
    search: z.string().optional(),
  })
  .passthrough();
export type NostrFilter = z.infer<typeof NostrFilterSchema>;

/** Configuration for a Nostr relay connection */
export const RelayConfigSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** WebSocket URL of the relay */
    url: z.string().url(),
    /** Whether to read events from this relay */
    read: z.boolean(),
    /** Whether to write events to this relay */
    write: z.boolean(),
  })
  .passthrough();
export type RelayConfig = z.infer<typeof RelayConfigSchema>;

/** Runtime status of a relay connection */
export const RelayStatusSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    url: z.string(),
    connected: z.boolean(),
    connecting: z.boolean(),
    error: z.union([z.string(), z.null()]).optional(),
    /** Unix timestamp of last successful connection */
    lastConnected: z.union([z.number().int(), z.null()]).optional(),
    messagesSent: z.number().int().optional(),
    messagesReceived: z.number().int().optional(),
  })
  .passthrough();
export type RelayStatus = z.infer<typeof RelayStatusSchema>;

/** NIP-11 relay limitation settings */
export const RelayLimitationSchema = z.object({
  _v: z.string().default("1.0.0"),
  max_message_length: z.number().int().optional(),
  max_subscriptions: z.number().int().optional(),
  max_filters: z.number().int().optional(),
  max_limit: z.number().int().optional(),
  max_subid_length: z.number().int().optional(),
  min_prefix: z.number().int().optional(),
  max_event_tags: z.number().int().optional(),
  max_content_length: z.number().int().optional(),
  min_pow_difficulty: z.number().int().optional(),
  auth_required: z.boolean().optional(),
  payment_required: z.boolean().optional(),
});
export type RelayLimitation = z.infer<typeof RelayLimitationSchema>;

/** Relay information document (NIP-11) */
export const RelayInfoSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    name: z.string(),
    description: z.string(),
    pubkey: z.string().optional(),
    contact: z.string().optional(),
    supported_nips: z.array(z.number().int()),
    software: z.string(),
    version: z.string(),
    icon: z.string().optional(),
    limitation: RelayLimitationSchema.optional(),
    payments_url: z.string().optional(),
  })
  .passthrough();
export type RelayInfo = z.infer<typeof RelayInfoSchema>;

/** Result of publishing an event to a relay */
export const PublishResultSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    relay: z.string(),
    success: z.boolean(),
    error: z.string().optional(),
  })
  .passthrough();
export type PublishResult = z.infer<typeof PublishResultSchema>;

/** NIP-17 rumor (unencrypted inner event) */
export const RumorSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    kind: z.number().int(),
    content: z.string(),
    created_at: z.number().int(),
    tags: z.array(z.array(z.string())),
  })
  .passthrough();
export type Rumor = z.infer<typeof RumorSchema>;

/** NIP-17 seal (kind 13 encrypted rumor) */
export const SealSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Always 13 for Seal events */
    kind: z.number().int(),
    content: z.string(),
    created_at: z.number().int(),
    tags: z.array(z.array(z.string())),
    id: z.string(),
    pubkey: z.string(),
    sig: z.string(),
  })
  .passthrough();
export type Seal = z.infer<typeof SealSchema>;

/** NIP-17 gift wrap (kind 1059 outer envelope) */
export const GiftWrapSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Always 1059 for GiftWrap events */
    kind: z.number().int(),
    content: z.string(),
    created_at: z.number().int(),
    tags: z.array(z.array(z.string())),
    id: z.string(),
    /** Ephemeral key */
    pubkey: z.string(),
    sig: z.string(),
  })
  .passthrough();
export type GiftWrap = z.infer<typeof GiftWrapSchema>;

/** Module version */
export const NOSTR_SCHEMA_VERSION = "1.0.0" as const;
