/**
 * @generated from protocol/schemas/modules/ble-transport/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the BleTransport module
 */

import { z } from "zod";

/** BLE connection state */
export const ConnectionStatusSchema = z.enum([
  "disconnected",
  "connecting",
  "connected",
  "disconnecting",
  "handshaking",
  "authenticated",
]);
export type ConnectionStatus = z.infer<typeof ConnectionStatusSchema>;

/** BLE identity commitment for mutual authentication handshake */
export const IdentityCommitmentSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Base64-encoded commitment hash */
    commitment: z.string(),
    /** Base64-encoded random nonce */
    nonce: z.string(),
    /** Hex-encoded public key */
    pubkey: z.string(),
  })
  .passthrough();
export type IdentityCommitment = z.infer<typeof IdentityCommitmentSchema>;

/** A BLE device discovered during scanning */
export const DiscoveredDeviceSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** BLE device address */
    address: z.string(),
    /** Advertised device name */
    name: z.union([z.string(), z.null()]).optional(),
    /** Signal strength in dBm */
    rssi: z.union([z.number().int(), z.null()]).optional(),
    /** Whether the device is a BuildIt node */
    isBuilditDevice: z.boolean(),
    /** Unix timestamp (milliseconds) */
    lastSeen: z.number().int(),
    /** Base64-encoded identity commitment if available */
    identityCommitment: z.union([z.string(), z.null()]).optional(),
    /** Hex-encoded verified public key after handshake */
    verifiedPubkey: z.union([z.string(), z.null()]).optional(),
  })
  .passthrough();
export type DiscoveredDevice = z.infer<typeof DiscoveredDeviceSchema>;

/** A BLE mesh event notification */
export const BleEventSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Event type */
    type: z.enum([
      "device_discovered",
      "device_updated",
      "device_lost",
      "connection_changed",
      "message_received",
      "message_sent",
    ]),
    /** Device address for device events */
    address: z.string().optional(),
    status: ConnectionStatusSchema.optional(),
  })
  .passthrough();
export type BleEvent = z.infer<typeof BleEventSchema>;

/** Header for BLE message chunking protocol */
export const ChunkHeaderSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Unique message identifier */
    messageId: z.string().uuid(),
    /** Zero-based chunk index */
    chunkIndex: z.number().int().gte(0).lte(255),
    /** Total number of chunks */
    totalChunks: z.number().int().gte(1).lte(255),
    /** Payload size in bytes */
    payloadLength: z.number().int(),
    /** Whether payload is zlib-compressed */
    compressed: z.boolean(),
  })
  .passthrough();
export type ChunkHeader = z.infer<typeof ChunkHeaderSchema>;

/** A single BLE message chunk */
export const ChunkSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    header: ChunkHeaderSchema,
    /** Base64-encoded chunk payload */
    payload: z.string(),
  })
  .passthrough();
export type Chunk = z.infer<typeof ChunkSchema>;

/** Module version */
export const BLE_TRANSPORT_SCHEMA_VERSION = "1.0.0" as const;
