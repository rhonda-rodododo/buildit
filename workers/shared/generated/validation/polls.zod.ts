/**
 * @generated from protocol/schemas/modules/polls/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Polls module
 */

import { z } from "zod";

/** Poll voting style */
export const PollTypeSchema = z.enum(["single", "multiple", "ranked_choice"]);
export type PollType = z.infer<typeof PollTypeSchema>;

/** Poll lifecycle status */
export const PollStatusSchema = z.enum([
  "draft",
  "active",
  "closed",
  "cancelled",
]);
export type PollStatus = z.infer<typeof PollStatusSchema>;

/** A single poll option */
export const PollOptionSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    text: z.string().max(256),
    voteCount: z.number().int().gte(0),
  })
  .passthrough();
export type PollOption = z.infer<typeof PollOptionSchema>;

/** A poll attached to a post or standalone */
export const PollSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    /** Associated post ID if embedded */
    postId: z.string().optional(),
    authorId: z.string(),
    question: z.string().max(512),
    options: z.array(PollOptionSchema),
    pollType: PollTypeSchema,
    status: PollStatusSchema.optional(),
    /** Unix timestamp when poll closes */
    endsAt: z.number().int(),
    isEnded: z.boolean().optional(),
    totalVotes: z.number().int(),
    voterCount: z.number().int().optional(),
    hideResultsUntilEnded: z.boolean().optional(),
    allowAnonymousVotes: z.boolean().optional(),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    nostrEventId: z.string().optional(),
  })
  .passthrough();
export type Poll = z.infer<typeof PollSchema>;

/** A vote cast on a poll */
export const PollVoteSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    pollId: z.string(),
    optionIds: z.array(z.string()),
    voterId: z.string(),
    createdAt: z.number().int(),
    nostrEventId: z.string().optional(),
  })
  .passthrough();
export type PollVote = z.infer<typeof PollVoteSchema>;

/** Module version */
export const POLLS_SCHEMA_VERSION = "1.0.0" as const;
