/**
 * @generated from protocol/schemas/modules/microblogging/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Microblogging module
 */

import { z } from "zod";

/** Privacy level for posts */
export const PostPrivacySchema = z.enum([
  "public",
  "followers",
  "group",
  "encrypted",
]);
export type PostPrivacy = z.infer<typeof PostPrivacySchema>;

/** Primary content type of a post */
export const PostContentTypeSchema = z.enum([
  "text",
  "image",
  "video",
  "poll",
  "event-share",
  "document-share",
]);
export type PostContentType = z.infer<typeof PostContentTypeSchema>;

/** Emoji reaction type */
export const ReactionTypeSchema = z.enum([
  "heart",
  "fist",
  "fire",
  "eyes",
  "laugh",
  "thumbs_up",
]);
export type ReactionType = z.infer<typeof ReactionTypeSchema>;

/** Post visibility settings */
export const PostVisibilitySchema = z
  .object({
    _v: z.string().default("1.0.0"),
    privacy: PostPrivacySchema,
    groupIds: z.array(z.string()).optional(),
    allowedUsers: z.array(z.string()).optional(),
  })
  .passthrough();
export type PostVisibility = z.infer<typeof PostVisibilitySchema>;

/** A media file attached to a post */
export const MediaAttachmentSchema = z
  .object({
    id: z.string(),
    type: z.enum(["image", "video", "audio", "document"]),
    url: z.string(),
    thumbnailUrl: z.string().optional(),
    filename: z.string(),
    mimeType: z.string(),
    /** File size in bytes */
    size: z.number().int(),
    encrypted: z.boolean(),
    /** Base64 encoded encryption key */
    encryptionKey: z.string().optional(),
    contentWarning: z.boolean().optional(),
    blurOnLoad: z.boolean().optional(),
    /** Alt text for accessibility */
    alt: z.string().optional(),
    caption: z.string().optional(),
  })
  .passthrough();
export type MediaAttachment = z.infer<typeof MediaAttachmentSchema>;

/** Signal-style encrypted link preview (fetched by sender, zero third-party requests for recipients) */
export const PostLinkPreviewSchema = z
  .object({
    url: z.string(),
    title: z.string().optional(),
    description: z.string().optional(),
    siteName: z.string().optional(),
    /** Base64-encoded thumbnail */
    imageData: z.string().optional(),
    imageType: z.string().optional(),
    /** Base64-encoded favicon */
    faviconData: z.string().optional(),
  })
  .passthrough();
export type PostLinkPreview = z.infer<typeof PostLinkPreviewSchema>;

/** Privacy-preserving location data attached to a post */
export const PostLocationSchema = z
  .object({
    lat: z.number(),
    lng: z.number(),
    /** Display label for the location */
    label: z.string(),
    /** How precisely the location is shared */
    precision: z.enum(["exact", "area", "city", "region", "country"]),
  })
  .passthrough();
export type PostLocation = z.infer<typeof PostLocationSchema>;

/** A microblog post */
export const PostSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    authorId: z.string(),
    content: z.string().max(65536),
    contentType: PostContentTypeSchema,
    visibility: PostVisibilitySchema,
    /** Media files attached to the post */
    media: z.array(MediaAttachmentSchema).optional(),
    /** Privacy-preserving link previews (encrypted with post content) */
    linkPreviews: z.array(PostLinkPreviewSchema).optional(),
    location: PostLocationSchema.optional(),
    reactionCount: z.number().int().default(0),
    commentCount: z.number().int().default(0),
    repostCount: z.number().int().default(0),
    bookmarkCount: z.number().int().default(0),
    mentions: z.array(z.string()).optional(),
    hashtags: z.array(z.string()).optional(),
    links: z.array(z.string()).optional(),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    nostrEventId: z.string().optional(),
    relayUrls: z.array(z.string()).optional(),
    isRepost: z.boolean().optional(),
    repostedPostId: z.string().optional(),
    isQuote: z.boolean().optional(),
    quotedPostId: z.string().optional(),
    quotedContent: z.string().optional(),
    contentWarning: z.string().optional(),
    isSensitive: z.boolean().optional(),
    isPinned: z.boolean().optional(),
    pinnedAt: z.number().int().optional(),
  })
  .passthrough();
export type Post = z.infer<typeof PostSchema>;

/** A comment on a post (threaded) */
export const CommentSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    postId: z.string(),
    authorId: z.string(),
    content: z.string(),
    parentCommentId: z.string().optional(),
    depth: z.number().int().lte(3),
    reactionCount: z.number().int().default(0),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    nostrEventId: z.string().optional(),
    isReported: z.boolean().optional(),
  })
  .passthrough();
export type Comment = z.infer<typeof CommentSchema>;

/** A reaction on a post */
export const ReactionSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    postId: z.string(),
    userId: z.string(),
    type: ReactionTypeSchema,
    createdAt: z.number().int(),
    nostrEventId: z.string().optional(),
  })
  .passthrough();
export type Reaction = z.infer<typeof ReactionSchema>;

/** A repost or quote repost */
export const RepostSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    postId: z.string(),
    userId: z.string(),
    isQuote: z.boolean(),
    quoteContent: z.string().optional(),
    createdAt: z.number().int(),
    nostrEventId: z.string().optional(),
  })
  .passthrough();
export type Repost = z.infer<typeof RepostSchema>;

/** A bookmarked post */
export const BookmarkSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    id: z.string(),
    postId: z.string(),
    userId: z.string(),
    createdAt: z.number().int(),
    collectionId: z.string().optional(),
    tags: z.array(z.string()).optional(),
    notes: z.string().optional(),
  })
  .passthrough();
export type Bookmark = z.infer<typeof BookmarkSchema>;

/** Module version */
export const MICROBLOGGING_SCHEMA_VERSION = "1.0.0" as const;
