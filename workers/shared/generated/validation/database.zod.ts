/**
 * @generated from protocol/schemas/modules/database/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Database module
 */

import { z } from "zod";

/** A column definition in a table */
export const ColumnSchema = z.object({
  id: z.string(),
  name: z.string().max(64),
  type: z.enum([
    "text",
    "number",
    "boolean",
    "date",
    "datetime",
    "select",
    "multiselect",
    "user",
    "file",
    "url",
    "email",
    "phone",
    "currency",
    "percent",
    "formula",
  ]),
  description: z.string().max(256).optional(),
  required: z.boolean().default(false),
  unique: z.boolean().default(false),
  defaultValue: z.any().optional(),
  /** Options for select/multiselect columns */
  options: z
    .array(
      z.object({
        value: z.string(),
        label: z.string(),
        color: z.string().regex(new RegExp("^#[0-9A-Fa-f]{6}$")).optional(),
      }),
    )
    .optional(),
  /** Formula expression for formula columns */
  formula: z.string().optional(),
  /** Display width in pixels */
  width: z.number().int().optional(),
});
export type Column = z.infer<typeof ColumnSchema>;

/** A custom database table definition */
export const TableSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    /** Table name */
    name: z.string().max(128),
    description: z.string().max(1024).optional(),
    columns: z.array(ColumnSchema).min(1).max(100),
    groupId: z.string().optional(),
    visibility: z.enum(["private", "group", "public"]).default("group"),
    editPermission: z.enum(["owner", "editors", "group"]).default("group"),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
  })
  .passthrough();
export type Table = z.infer<typeof TableSchema>;

/** A row of data in a table */
export const RowSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    tableId: z.string().uuid(),
    /** Column ID to value mapping */
    data: z.record(z.string(), z.any()),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    updatedBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
  })
  .passthrough();
export type Row = z.infer<typeof RowSchema>;

export const FilterSchema = z.object({
  columnId: z.string(),
  operator: z.enum([
    "equals",
    "not_equals",
    "contains",
    "not_contains",
    "greater",
    "less",
    "greater_or_equal",
    "less_or_equal",
    "is_empty",
    "is_not_empty",
  ]),
  value: z.any().optional(),
});
export type Filter = z.infer<typeof FilterSchema>;

export const SortSchema = z.object({
  columnId: z.string(),
  direction: z.enum(["asc", "desc"]),
});
export type Sort = z.infer<typeof SortSchema>;

/** A saved view configuration for a table */
export const ViewSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    tableId: z.string().uuid(),
    name: z.string().max(128),
    type: z
      .enum(["table", "grid", "kanban", "calendar", "gallery", "list"])
      .default("table"),
    filters: z.array(FilterSchema).optional(),
    sorts: z.array(SortSchema).optional(),
    hiddenColumns: z.array(z.string()).optional(),
    /** Column ID to group by */
    groupBy: z.string().optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
  })
  .passthrough();
export type View = z.infer<typeof ViewSchema>;

/** Module version */
export const DATABASE_SCHEMA_VERSION = "1.0.0" as const;
