/**
 * @generated from protocol/schemas/modules/templates/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Templates module
 */

import { z } from "zod";

/** Hotline message template with variable substitution */
export const CallingTemplateContentSchema = z.object({
  /** Message text with {{variable}} placeholders */
  message: z.string(),
  /** Variable names used in the message template */
  variables: z.array(z.string()),
  /** Keyboard shortcut (e.g., 'Ctrl+G') */
  shortcut: z.union([z.string(), z.null()]).optional(),
});
export type CallingTemplateContent = z.infer<
  typeof CallingTemplateContentSchema
>;

/** A field definition for database/CRM tables */
export const FieldDefinitionSchema = z.object({
  name: z.string(),
  label: z.string(),
  schema: z
    .object({
      type: z
        .enum(["string", "number", "boolean", "array", "object"])
        .optional(),
      required: z.boolean().optional(),
      format: z.string().optional(),
      minimum: z.number().optional(),
      maximum: z.number().optional(),
      enum: z.array(z.any()).optional(),
      enumLabels: z.array(z.string()).optional(),
      items: z.record(z.string(), z.any()).optional(),
    })
    .optional(),
  widget: z.object({
    widget: z.enum([
      "text",
      "textarea",
      "number",
      "select",
      "multi-select",
      "checkbox",
      "date",
      "datetime",
      "relationship",
      "file",
    ]),
    placeholder: z.string().optional(),
    helpText: z.string().optional(),
    options: z
      .array(z.object({ value: z.string(), label: z.string() }))
      .optional(),
  }),
  order: z.number().int().gte(0).optional(),
});
export type FieldDefinition = z.infer<typeof FieldDefinitionSchema>;

export const TableDefinitionSchema = z.object({
  name: z.string(),
  description: z.string().optional(),
  fields: z.array(FieldDefinitionSchema),
});
export type TableDefinition = z.infer<typeof TableDefinitionSchema>;

export const RelationshipDefinitionSchema = z.object({
  sourceTable: z.string(),
  sourceField: z.string(),
  targetTable: z.string(),
  targetField: z.string(),
  type: z.enum(["one-to-one", "one-to-many", "many-to-one", "many-to-many"]),
  label: z.string().optional(),
  required: z.boolean().optional(),
  onDelete: z.enum(["cascade", "set-null", "restrict"]).optional(),
});
export type RelationshipDefinition = z.infer<
  typeof RelationshipDefinitionSchema
>;

/** Database template with tables and relationships */
export const DatabaseTemplateContentSchema = z.object({
  tables: z.array(TableDefinitionSchema),
  relationships: z.array(RelationshipDefinitionSchema),
});
export type DatabaseTemplateContent = z.infer<
  typeof DatabaseTemplateContentSchema
>;

export const ViewDefinitionSchema = z.object({
  name: z.string(),
  type: z.enum(["table", "board", "calendar", "gallery"]),
  config: z.record(z.string(), z.any()).optional(),
  filters: z.array(z.any()).optional(),
  sorts: z.array(z.any()).optional(),
});
export type ViewDefinition = z.infer<typeof ViewDefinitionSchema>;

/** Single-table CRM template with fields and views */
export const CRMSingleTableContentSchema = z.object({
  fields: z.array(FieldDefinitionSchema),
  defaultViews: z.array(ViewDefinitionSchema),
});
export type CRMSingleTableContent = z.infer<typeof CRMSingleTableContentSchema>;

/** Multi-table CRM template metadata (full schemas in client code) */
export const CRMMultiTableContentSchema = z.object({
  integrations: z
    .object({
      events: z.boolean().optional(),
      files: z.boolean().optional(),
      messaging: z.boolean().optional(),
      forms: z.boolean().optional(),
    })
    .optional(),
  tableCount: z.number().int().gte(1),
  tables: z.array(z.string()),
  tableDescriptions: z.record(z.string(), z.string()).optional(),
  relationshipCount: z.number().int().gte(0).optional(),
  seedData: z.record(z.string(), z.any()).optional(),
});
export type CRMMultiTableContent = z.infer<typeof CRMMultiTableContentSchema>;

/** Form template with backing table and settings */
export const FormTemplateContentSchema = z.object({
  title: z.string(),
  formDescription: z.string().optional(),
  backingTable: z.object({
    name: z.string(),
    description: z.string().optional(),
    icon: z.string().optional(),
    fields: z.array(
      z.object({
        name: z.string(),
        type: z.string(),
        required: z.boolean().optional(),
        description: z.string().optional(),
        options: z.array(z.string()).optional(),
      }),
    ),
  }),
  settings: z.record(z.string(), z.any()).optional(),
});
export type FormTemplateContent = z.infer<typeof FormTemplateContentSchema>;

/** Document template with HTML content */
export const DocumentTemplateContentSchema = z.object({
  /** HTML content for the document template */
  html: z.string(),
});
export type DocumentTemplateContent = z.infer<
  typeof DocumentTemplateContentSchema
>;

export const LessonDefinitionSchema = z.object({
  type: z.enum(["document", "quiz", "interactive", "video", "live-session"]),
  title: z.string(),
  description: z.string(),
  estimatedMinutes: z.number().int().gte(1),
  requiredForCertification: z.boolean().optional(),
  content: z.any().optional(),
});
export type LessonDefinition = z.infer<typeof LessonDefinitionSchema>;

export const ModuleDefinitionSchema = z.object({
  title: z.string(),
  description: z.string(),
  estimatedMinutes: z.number().int().gte(1).optional(),
  lessons: z.array(LessonDefinitionSchema),
});
export type ModuleDefinition = z.infer<typeof ModuleDefinitionSchema>;

/** Training course template with modules, lessons, and quizzes */
export const TrainingTemplateContentSchema = z.object({
  difficulty: z.enum(["beginner", "intermediate", "advanced"]),
  estimatedHours: z.number().gte(0.5),
  imageUrl: z.string().optional(),
  certificationEnabled: z.boolean(),
  certificationExpiryDays: z.union([z.number().int(), z.null()]).optional(),
  modules: z.array(ModuleDefinitionSchema).min(1),
});
export type TrainingTemplateContent = z.infer<
  typeof TrainingTemplateContentSchema
>;

/** A single template entry with metadata and module-specific content */
export const TemplateEntrySchema = z.object({
  /** Unique kebab-case identifier */
  id: z.string().regex(new RegExp("^[a-z0-9][a-z0-9-]*[a-z0-9]$")),
  /** Human-readable display name */
  name: z.string().min(1).max(100),
  /** Description of the template's purpose */
  description: z.string().min(1).max(500),
  /** Grouping category for filtering and display */
  category: z.string().optional(),
  /** Icon identifier - emoji or icon library reference */
  icon: z.string().optional(),
  /** Lowercase kebab-case tags for search and filtering */
  tags: z.array(z.string().regex(new RegExp("^[a-z0-9-]+$"))).optional(),
  /** Template author or contributing organization */
  author: z.string().optional(),
  /** Template-level version for tracking updates */
  version: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")).optional(),
  /** Module-specific template content. Structure depends on the module type. */
  content: z.union([
    CallingTemplateContentSchema,
    DatabaseTemplateContentSchema,
    CRMSingleTableContentSchema,
    CRMMultiTableContentSchema,
    FormTemplateContentSchema,
    DocumentTemplateContentSchema,
    TrainingTemplateContentSchema,
  ]),
});
export type TemplateEntry = z.infer<typeof TemplateEntrySchema>;

export const QuizQuestionSchema = z.object({
  id: z.string(),
  type: z.enum(["multiple-choice", "true-false", "multi-select"]),
  question: z.string(),
  options: z.array(z.string()),
  correctAnswer: z.any(),
  explanation: z.string().optional(),
  points: z.number().int().gte(1).optional(),
  order: z.number().int().optional(),
});
export type QuizQuestion = z.infer<typeof QuizQuestionSchema>;

export const QuizContentSchema = z.object({
  type: z.literal("quiz"),
  passingScore: z.number().int().gte(0).lte(100),
  allowRetakes: z.boolean().optional(),
  maxAttempts: z.number().int().gte(1).optional(),
  shuffleQuestions: z.boolean().optional(),
  shuffleOptions: z.boolean().optional(),
  showCorrectAfter: z.boolean().optional(),
  questions: z.array(QuizQuestionSchema),
});
export type QuizContent = z.infer<typeof QuizContentSchema>;

/** Module version */
export const TEMPLATES_SCHEMA_VERSION = "1.0.0" as const;
