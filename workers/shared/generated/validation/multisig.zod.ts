/**
 * @generated from protocol/schemas/modules/multisig/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Multisig module
 */

import { z } from "zod";

/** A single share of a threshold key group */
export const KeyShareSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Share index (1-based) */
    index: z.number().int(),
    /** Base64-encoded share secret (sensitive) */
    shareSecret: z.string().optional(),
    /** Hex-encoded share public key */
    sharePublicKey: z.string(),
    /** ID of the threshold key group */
    groupId: z.string(),
    /** Total number of shares in the group */
    totalShares: z.number().int(),
    /** Minimum shares needed to sign */
    threshold: z.number().int(),
  })
  .passthrough();
export type KeyShare = z.infer<typeof KeyShareSchema>;

/** Configuration for creating a threshold key group */
export const ThresholdConfigSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Minimum shares needed to sign */
    threshold: z.number().int().gte(2),
    /** Total number of shares to create */
    totalShares: z.number().int().gte(2),
    /** Human-readable group name */
    groupName: z.string(),
  })
  .passthrough();
export type ThresholdConfig = z.infer<typeof ThresholdConfigSchema>;

/** A complete threshold key group with all shares */
export const ThresholdKeyGroupSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    groupId: z.string(),
    /** Hex-encoded group public key */
    groupPublicKey: z.string(),
    shares: z.array(KeyShareSchema),
    threshold: z.number().int(),
    totalShares: z.number().int(),
  })
  .passthrough();
export type ThresholdKeyGroup = z.infer<typeof ThresholdKeyGroupSchema>;

/** A partial signature from one share holder */
export const PartialSignatureSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    signerIndex: z.number().int(),
    /** Base64-encoded partial signature */
    signature: z.string(),
    signerPublicKey: z.string(),
  })
  .passthrough();
export type PartialSignature = z.infer<typeof PartialSignatureSchema>;

/** An aggregated threshold signature */
export const AggregatedSignatureSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Base64-encoded aggregated signature */
    signature: z.string(),
    groupPublicKey: z.string(),
    signerIndices: z.array(z.number().int()),
  })
  .passthrough();
export type AggregatedSignature = z.infer<typeof AggregatedSignatureSchema>;

/** A proposal to rotate a threshold key group */
export const KeyRotationProposalSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    proposalId: z.string(),
    groupId: z.string(),
    newGroupPublicKey: z.string(),
    newShares: z.array(KeyShareSchema).optional(),
    createdAt: z.number().int(),
  })
  .passthrough();
export type KeyRotationProposal = z.infer<typeof KeyRotationProposalSchema>;

/** Module version */
export const MULTISIG_SCHEMA_VERSION = "1.0.0" as const;
