/**
 * @generated from protocol/schemas/modules/marketplace/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Marketplace module
 */

import { z } from "zod";

/** A marketplace listing for products, services, co-op goods, initiatives, or shared resources */
export const ListingSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    /** Category of listing */
    type: z.enum(["product", "service", "co-op", "initiative", "resource"]),
    title: z.string().max(256),
    description: z.string().max(8192).optional(),
    /** Price in smallest currency unit (cents). Null or 0 for free/negotiable */
    price: z.number().gte(0).optional(),
    /** ISO 4217 currency code */
    currency: z.string().regex(new RegExp("^[A-Z]{3}$")).optional(),
    /** Image URLs for the listing */
    images: z.array(z.string().url()).max(10).optional(),
    /** Location using custom-fields LocationValue type (privacy-aware precision) */
    location: z.unknown().optional(),
    /** Freeform availability description (e.g., 'Weekdays 9-5', 'Immediate') */
    availability: z.string().max(256).optional(),
    tags: z.array(z.string().max(64)).max(20).optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    /** Unix timestamp when listing expires */
    expiresAt: z.number().int().optional(),
    status: z.enum(["active", "sold", "expired", "removed"]).default("active"),
    /** Group this listing belongs to */
    groupId: z.string().optional(),
    /** Associated co-op profile ID, if applicable */
    coopId: z.string().uuid().optional(),
    /** How buyers should contact the seller */
    contactMethod: z.enum(["dm", "public-reply"]).default("dm"),
  })
  .passthrough();
export type Listing = z.infer<typeof ListingSchema>;

/** A worker cooperative or collective profile */
export const CoopProfileSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    name: z.string().max(256),
    description: z.string().max(8192).optional(),
    memberCount: z.number().int().gte(1).optional(),
    /** How the co-op makes decisions */
    governanceModel: z
      .enum([
        "consensus",
        "democratic",
        "sociocracy",
        "holacracy",
        "hybrid",
        "other",
      ])
      .optional(),
    /** Industry or sector */
    industry: z.string().max(128).optional(),
    location: z.unknown().optional(),
    website: z.string().url().optional(),
    /** Nostr public key for the co-op identity */
    nostrPubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** Pubkeys of people who have vouched for this co-op */
    verifiedBy: z
      .array(z.string().regex(new RegExp("^[0-9a-f]{64}$")))
      .optional(),
    /** Co-op logo or profile image */
    image: z.string().url().optional(),
    createdAt: z.number().int().optional(),
    updatedAt: z.number().int().optional(),
    groupId: z.string().optional(),
  })
  .passthrough();
export type CoopProfile = z.infer<typeof CoopProfileSchema>;

/** A review for a listing or co-op */
export const ReviewSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    /** The listing or co-op being reviewed */
    listingId: z.string().uuid(),
    reviewerPubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    rating: z.number().int().gte(1).lte(5),
    text: z.string().max(2048).optional(),
    createdAt: z.number().int(),
  })
  .passthrough();
export type Review = z.infer<typeof ReviewSchema>;

/** A time-banking or skill exchange offer */
export const SkillExchangeSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    /** Skill the user can offer */
    offeredSkill: z.string().max(256),
    /** Skill the user is looking for in exchange */
    requestedSkill: z.string().max(256),
    /** Hours per week available for exchange */
    availableHours: z.number().gte(0).optional(),
    /** Accumulated timebank hours */
    hourlyTimebank: z.number().gte(0).optional(),
    location: z.unknown().optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    status: z
      .enum(["active", "matched", "completed", "cancelled"])
      .default("active"),
    groupId: z.string().optional(),
  })
  .passthrough();
export type SkillExchange = z.infer<typeof SkillExchangeSchema>;

/** A shared resource (tool, space, vehicle) available for borrowing */
export const ResourceShareSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    /** Category of shared resource */
    resourceType: z.enum(["tool", "space", "vehicle"]),
    name: z.string().max(256),
    description: z.string().max(4096).optional(),
    /** Weekly availability schedule */
    availability: z
      .array(
        z.object({
          dayOfWeek: z.number().int().gte(0).lte(6),
          startHour: z.number().int().gte(0).lte(23),
          endHour: z.number().int().gte(0).lte(23),
        }),
      )
      .optional(),
    location: z.unknown().optional(),
    /** Whether a deposit is required to borrow */
    depositRequired: z.boolean().default(false),
    /** Deposit amount in smallest currency unit */
    depositAmount: z.number().gte(0).optional(),
    depositCurrency: z.string().regex(new RegExp("^[A-Z]{3}$")).optional(),
    images: z.array(z.string().url()).max(5).optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
    status: z
      .enum(["available", "borrowed", "unavailable"])
      .default("available"),
    groupId: z.string().optional(),
  })
  .passthrough();
export type ResourceShare = z.infer<typeof ResourceShareSchema>;

/** Module version */
export const MARKETPLACE_SCHEMA_VERSION = "1.0.0" as const;
