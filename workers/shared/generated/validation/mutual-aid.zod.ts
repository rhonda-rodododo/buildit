/**
 * @generated from protocol/schemas/modules/mutual-aid/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the MutualAid module
 */

import { z } from "zod";

/** Category of aid */
export const AidCategorySchema = z.enum([
  "food",
  "housing",
  "transportation",
  "rideshare",
  "medical",
  "mental-health",
  "childcare",
  "pet-care",
  "legal",
  "financial",
  "employment",
  "education",
  "technology",
  "translation",
  "supplies",
  "clothing",
  "furniture",
  "household",
  "safety",
  "other",
]);
export type AidCategory = z.infer<typeof AidCategorySchema>;

export const RequestStatusSchema = z.enum([
  "open",
  "in-progress",
  "partially-fulfilled",
  "fulfilled",
  "closed",
  "expired",
  "cancelled",
]);
export type RequestStatus = z.infer<typeof RequestStatusSchema>;

/** Urgency level of the request */
export const UrgencyLevelSchema = z.enum(["low", "medium", "high", "critical"]);
export type UrgencyLevel = z.infer<typeof UrgencyLevelSchema>;

export const LocationSchema = z.object({
  type: z.enum(["point", "area", "flexible", "remote"]).optional(),
  address: z.string().optional(),
  city: z.string().optional(),
  region: z.string().optional(),
  postalCode: z.string().optional(),
  country: z.string().optional(),
  coordinates: z
    .object({
      lat: z.number().gte(-90).lte(90).optional(),
      lng: z.number().gte(-180).lte(180).optional(),
    })
    .optional(),
  /** Radius in kilometers for area type */
  radius: z.number().optional(),
  privacyLevel: z
    .enum(["exact", "approximate", "city-only", "hidden"])
    .default("approximate"),
});
export type Location = z.infer<typeof LocationSchema>;

export const RecurringNeedSchema = z.object({
  frequency: z.enum(["daily", "weekly", "biweekly", "monthly", "custom"]),
  interval: z.number().int().gte(1).optional(),
  daysOfWeek: z.array(z.number().int().gte(0).lte(6)).optional(),
  endDate: z.number().int().optional(),
  occurrences: z.number().int().optional(),
});
export type RecurringNeed = z.infer<typeof RecurringNeedSchema>;

/** A fulfillment response to a request */
export const FulfillmentSchema = z.object({
  _v: z.string().default("1.0.0"),
  id: z.string().uuid(),
  requestId: z.string().uuid(),
  fulfillerId: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
  status: z.enum([
    "offered",
    "accepted",
    "in-progress",
    "completed",
    "cancelled",
    "declined",
  ]),
  quantity: z.number().gte(0).optional(),
  message: z.string().optional(),
  scheduledFor: z.number().int().optional(),
  completedAt: z.number().int().optional(),
  rating: z.number().int().gte(1).lte(5).optional(),
  feedback: z.string().optional(),
  createdAt: z.number().int(),
});
export type Fulfillment = z.infer<typeof FulfillmentSchema>;

/** A request for mutual aid */
export const AidRequestSchema = z.object({
  /** Schema version for graceful degradation */
  _v: z.string().default("1.0.0"),
  /** Unique identifier for the request */
  id: z.string().uuid(),
  /** Group this request belongs to */
  groupId: z.string().uuid(),
  /** Brief title of the request */
  title: z.string().min(1).max(200),
  /** Detailed description of the need */
  description: z.string().optional(),
  category: AidCategorySchema,
  status: RequestStatusSchema,
  urgency: UrgencyLevelSchema.optional(),
  /** Public key of the person making the request */
  requesterId: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
  /** Hide requester identity from public */
  anonymousRequest: z.boolean().default(false),
  location: LocationSchema.optional(),
  /** Unix timestamp of when the need must be fulfilled */
  neededBy: z.number().int().optional(),
  recurringNeed: RecurringNeedSchema.optional(),
  /** Fulfillment responses */
  fulfillments: z.array(FulfillmentSchema).optional(),
  /** Quantity needed (if applicable) */
  quantityNeeded: z.number().gte(0).optional(),
  /** Quantity already fulfilled */
  quantityFulfilled: z.number().gte(0).default(0),
  /** Unit for quantity (e.g., 'meals', 'hours', 'dollars') */
  unit: z.string().optional(),
  /** Categorization tags */
  tags: z.array(z.string()).optional(),
  /** Custom field values from custom-fields module */
  customFields: z.record(z.string(), z.any()).optional(),
  /** Unix timestamp of creation */
  createdAt: z.number().int(),
  /** Unix timestamp of last update */
  updatedAt: z.number().int().optional(),
  /** Unix timestamp when request was closed */
  closedAt: z.number().int().optional(),
});
export type AidRequest = z.infer<typeof AidRequestSchema>;

export const OfferClaimSchema = z.object({
  claimerId: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
  quantity: z.number().optional(),
  message: z.string().optional(),
  status: z.enum(["pending", "approved", "declined", "completed"]),
  claimedAt: z.number().int(),
});
export type OfferClaim = z.infer<typeof OfferClaimSchema>;

/** An offer of mutual aid */
export const AidOfferSchema = z.object({
  _v: z.string().default("1.0.0"),
  id: z.string().uuid(),
  groupId: z.string().uuid(),
  title: z.string().min(1).max(200),
  description: z.string().optional(),
  category: AidCategorySchema,
  status: z
    .enum(["active", "claimed", "expired", "withdrawn"])
    .default("active"),
  offererId: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
  location: LocationSchema.optional(),
  /** Unix timestamp when offer becomes available */
  availableFrom: z.number().int().optional(),
  /** Unix timestamp when offer expires */
  availableUntil: z.number().int().optional(),
  recurringAvailability: RecurringNeedSchema.optional(),
  quantity: z.number().gte(0).optional(),
  unit: z.string().optional(),
  claimedBy: z.array(OfferClaimSchema).optional(),
  tags: z.array(z.string()).optional(),
  customFields: z.record(z.string(), z.any()).optional(),
  createdAt: z.number().int(),
  updatedAt: z.number().int().optional(),
});
export type AidOffer = z.infer<typeof AidOfferSchema>;

/** A solidarity rideshare offer or request */
export const RideShareSchema = z.object({
  _v: z.string().default("1.0.0"),
  id: z.string().uuid(),
  groupId: z.string().uuid(),
  type: z.enum(["offer", "request"]),
  /** Driver's public key (for offers) */
  driverId: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
  /** Requester's public key (for requests) */
  requesterId: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
  origin: LocationSchema,
  destination: LocationSchema,
  departureTime: z.number().int(),
  /** Flexibility in minutes */
  flexibility: z.number().int().optional(),
  availableSeats: z.number().int().gte(1).optional(),
  recurring: RecurringNeedSchema.optional(),
  preferences: z
    .object({
      smokingAllowed: z.boolean().optional(),
      petsAllowed: z.boolean().optional(),
      wheelchairAccessible: z.boolean().optional(),
      carSeatAvailable: z.boolean().optional(),
      luggageSpace: z.enum(["none", "small", "medium", "large"]).optional(),
    })
    .optional(),
  passengers: z
    .array(
      z.object({
        passengerId: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
        status: z.enum(["requested", "confirmed", "cancelled"]).optional(),
        pickup: LocationSchema.optional(),
        dropoff: LocationSchema.optional(),
      }),
    )
    .optional(),
  status: z.enum(["active", "full", "departed", "completed", "cancelled"]),
  notes: z.string().optional(),
  createdAt: z.number().int(),
  updatedAt: z.number().int().optional(),
});
export type RideShare = z.infer<typeof RideShareSchema>;

/** Community resource directory entry */
export const ResourceDirectorySchema = z.object({
  _v: z.string().default("1.0.0"),
  id: z.string().uuid(),
  groupId: z.string().uuid(),
  name: z.string(),
  description: z.string().optional(),
  category: AidCategorySchema,
  contact: z
    .object({
      phone: z.string().optional(),
      email: z.string().email().optional(),
      website: z.string().url().optional(),
    })
    .optional(),
  location: LocationSchema.optional(),
  hours: z.string().optional(),
  eligibility: z.string().optional(),
  languages: z.array(z.string()).optional(),
  verified: z.boolean().default(false),
  verifiedBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
  verifiedAt: z.number().int().optional(),
  tags: z.array(z.string()).optional(),
  createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
  createdAt: z.number().int(),
  updatedAt: z.number().int().optional(),
});
export type ResourceDirectory = z.infer<typeof ResourceDirectorySchema>;

/** Module version */
export const MUTUAL_AID_SCHEMA_VERSION = "1.0.0" as const;
