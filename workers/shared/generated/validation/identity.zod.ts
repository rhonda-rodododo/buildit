/**
 * @generated from protocol/schemas/modules/identity/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Identity module
 */

import { z } from "zod";

/** A Nostr keypair identity with profile metadata */
export const IdentitySchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Hex-encoded public key */
    publicKey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    /** Bech32-encoded public key (npub...) */
    npub: z.string(),
    /** User-chosen identity name */
    name: z.string(),
    /** Human-readable username (e.g., alice-organizer) */
    username: z.string().optional(),
    /** Display name (e.g., Alice Martinez) */
    displayName: z.string().optional(),
    /** NIP-05 verified identifier (alice@domain.com) */
    nip05: z.string().optional(),
    /** Whether NIP-05 has been verified */
    nip05Verified: z.boolean().optional(),
    /** Unix timestamp when identity was created */
    created: z.number().int(),
    /** Unix timestamp when identity was last used */
    lastUsed: z.number().int(),
  })
  .passthrough();
export type Identity = z.infer<typeof IdentitySchema>;

/** An identity with password-encrypted private key for storage */
export const EncryptedIdentitySchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Hex-encoded public key */
    publicKey: z.string(),
    /** Password-encrypted private key (Argon2id + AES-256-GCM) */
    encryptedPrivateKey: z.string(),
    name: z.string(),
    created: z.number().int(),
    lastUsed: z.number().int(),
  })
  .passthrough();
export type EncryptedIdentity = z.infer<typeof EncryptedIdentitySchema>;

/** User profile metadata (NIP-01 kind 0 content) */
export const ProfileMetadataSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    name: z.string().optional(),
    display_name: z.string().optional(),
    about: z.string().optional(),
    picture: z.string().url().optional(),
    banner: z.string().url().optional(),
    nip05: z.string().optional(),
    lud16: z.string().optional(),
    website: z.string().url().optional(),
  })
  .passthrough();
export type ProfileMetadata = z.infer<typeof ProfileMetadataSchema>;

/** Module version */
export const IDENTITY_SCHEMA_VERSION = "1.0.0" as const;
