/**
 * @generated from protocol/schemas/modules/security/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Security module
 */

import { z } from "zod";

/** A decoy identity shown under duress */
export const DecoyIdentitySchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Display name for the decoy identity */
    displayName: z.string(),
    /** Bio/about text for the decoy */
    about: z.string(),
    /** Unix timestamp when created */
    createdAt: z.number().int(),
  })
  .passthrough();
export type DecoyIdentity = z.infer<typeof DecoyIdentitySchema>;

/** Result of checking whether a password is a duress password */
export const DuressCheckResultSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Whether the duress password was used */
    isDuress: z.boolean(),
    /** Whether any valid password was entered */
    passwordValid: z.boolean(),
  })
  .passthrough();
export type DuressCheckResult = z.infer<typeof DuressCheckResultSchema>;

/** Configuration for alerts sent when duress is detected */
export const DuressAlertConfigSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Public keys of trusted contacts to alert */
    trustedContactPubkeys: z.array(z.string()),
    /** Whether to include GPS location in alert */
    includeLocation: z.boolean(),
    /** Optional custom alert message */
    customMessage: z.union([z.string(), z.null()]).optional(),
  })
  .passthrough();
export type DuressAlertConfig = z.infer<typeof DuressAlertConfigSchema>;

/** A fake contact shown in the decoy identity's contact list */
export const DecoyContactSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Public key of the decoy contact */
    pubkey: z.string(),
    /** Display name of the decoy contact */
    displayName: z.string(),
  })
  .passthrough();
export type DecoyContact = z.infer<typeof DecoyContactSchema>;

/** Module version */
export const SECURITY_SCHEMA_VERSION = "1.0.0" as const;
