/**
 * @generated from protocol/schemas/modules/forms/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Forms module
 */

import { z } from "zod";

/** Status of a form */
export const FormStatusSchema = z.enum(["draft", "open", "closed", "archived"]);
export type FormStatus = z.infer<typeof FormStatusSchema>;

/** Validation rules for a field */
export const FieldValidationSchema = z.object({
  minLength: z.number().int().optional(),
  maxLength: z.number().int().optional(),
  min: z.number().optional(),
  max: z.number().optional(),
  pattern: z.string().optional(),
  customError: z.string().optional(),
});
export type FieldValidation = z.infer<typeof FieldValidationSchema>;

/** Conditional display logic */
export const ConditionalLogicSchema = z.object({
  field: z.string(),
  operator: z.enum([
    "equals",
    "not_equals",
    "contains",
    "not_contains",
    "greater",
    "less",
  ]),
  value: z.any(),
});
export type ConditionalLogic = z.infer<typeof ConditionalLogicSchema>;

/** A single form field/question */
export const FormFieldSchema = z
  .object({
    id: z.string(),
    type: z.enum([
      "text",
      "textarea",
      "number",
      "email",
      "phone",
      "url",
      "date",
      "time",
      "datetime",
      "select",
      "multiselect",
      "radio",
      "checkbox",
      "file",
      "rating",
      "scale",
      "location",
    ]),
    label: z.string().max(512),
    description: z.string().max(1024).optional(),
    placeholder: z.string().max(256).optional(),
    required: z.boolean().default(false),
    /** Options for select/radio/checkbox fields */
    options: z
      .array(z.object({ value: z.string(), label: z.string() }))
      .optional(),
    validation: FieldValidationSchema.optional(),
    conditional: ConditionalLogicSchema.optional(),
  })
  .passthrough();
export type FormField = z.infer<typeof FormFieldSchema>;

/** A form with questions and settings */
export const FormSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    title: z.string().max(256),
    description: z.string().max(2048).optional(),
    fields: z.array(FormFieldSchema).min(1).max(100),
    groupId: z.string().optional(),
    visibility: z.enum(["private", "group", "public"]).default("group"),
    /** Whether responses are anonymous */
    anonymous: z.boolean().default(false),
    /** Allow multiple submissions per user */
    allowMultiple: z.boolean().default(false),
    /** When form opens for submissions */
    opensAt: z.number().int().optional(),
    /** When form closes for submissions */
    closesAt: z.number().int().optional(),
    /** Maximum number of responses */
    maxResponses: z.number().int().gte(1).optional(),
    /** Message shown after submission */
    confirmationMessage: z.string().max(1024).optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    status: FormStatusSchema.optional(),
    updatedAt: z.number().int().optional(),
  })
  .passthrough();
export type Form = z.infer<typeof FormSchema>;

/** A submitted form response */
export const FormResponseSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    formId: z.string().uuid(),
    /** Field ID to answer value mapping */
    answers: z.record(z.string(), z.any()),
    /** Respondent pubkey (null if anonymous) */
    respondent: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
    submittedAt: z.number().int(),
  })
  .passthrough();
export type FormResponse = z.infer<typeof FormResponseSchema>;

/** Module version */
export const FORMS_SCHEMA_VERSION = "1.0.0" as const;
