/**
 * @generated from protocol/schemas/modules/newsletters/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Newsletters module
 */

import { z } from "zod";

/** A newsletter/mailing list configuration */
export const NewsletterSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    name: z.string().max(128),
    description: z.string().max(2048).optional(),
    groupId: z.string().optional(),
    /** Sender display name */
    fromName: z.string().max(128).optional(),
    replyTo: z.string().email().optional(),
    logo: z.string().url().optional(),
    subscriberCount: z.number().int().default(0),
    visibility: z.enum(["private", "group", "public"]).default("group"),
    /** Require email confirmation for subscriptions */
    doubleOptIn: z.boolean().default(true),
    ownerPubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    editors: z.array(z.string().regex(new RegExp("^[0-9a-f]{64}$"))).optional(),
    createdAt: z.number().int(),
  })
  .passthrough();
export type Newsletter = z.infer<typeof NewsletterSchema>;

/** An email campaign/issue */
export const CampaignSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    newsletterId: z.string().uuid(),
    subject: z.string().max(256),
    /** Preview text shown in email clients */
    preheader: z.string().max(256).optional(),
    /** Email content (HTML or markdown) */
    content: z.string().max(1048576),
    contentType: z.enum(["html", "markdown"]).default("markdown"),
    status: z
      .enum(["draft", "scheduled", "sending", "sent", "failed"])
      .default("draft"),
    /** Scheduled send time */
    scheduledAt: z.number().int().optional(),
    /** Actual send time */
    sentAt: z.number().int().optional(),
    /** Number of recipients */
    recipientCount: z.number().int().optional(),
    openCount: z.number().int().default(0),
    clickCount: z.number().int().default(0),
    /** Subscriber segments to send to */
    segments: z.array(z.string()).optional(),
    /** Signal-style encrypted link previews for URLs in campaign content */
    linkPreviews: z.array(z.unknown()).max(10).optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
    updatedAt: z.number().int().optional(),
  })
  .passthrough();
export type Campaign = z.infer<typeof CampaignSchema>;

/** A newsletter subscriber */
export const SubscriberSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    newsletterId: z.string().uuid(),
    /** BuildIt user pubkey if linked */
    pubkey: z.string().regex(new RegExp("^[0-9a-f]{64}$")).optional(),
    email: z.string().email(),
    name: z.string().max(128).optional(),
    status: z
      .enum(["pending", "active", "unsubscribed", "bounced", "complained"])
      .default("pending"),
    /** Segments this subscriber belongs to */
    segments: z.array(z.string()).optional(),
    customFields: z.record(z.string(), z.any()).optional(),
    /** How subscriber was acquired */
    source: z.string().max(128).optional(),
    subscribedAt: z.number().int(),
    confirmedAt: z.number().int().optional(),
    unsubscribedAt: z.number().int().optional(),
  })
  .passthrough();
export type Subscriber = z.infer<typeof SubscriberSchema>;

/** An email template */
export const TemplateSchema = z
  .object({
    _v: z.string().regex(new RegExp("^\\d+\\.\\d+\\.\\d+$")),
    id: z.string().uuid(),
    newsletterId: z.string().uuid().optional(),
    name: z.string().max(128),
    content: z.string().max(524288),
    contentType: z.enum(["html", "markdown"]).default("markdown"),
    thumbnail: z.string().url().optional(),
    createdBy: z.string().regex(new RegExp("^[0-9a-f]{64}$")),
    createdAt: z.number().int(),
  })
  .passthrough();
export type Template = z.infer<typeof TemplateSchema>;

/** Module version */
export const NEWSLETTERS_SCHEMA_VERSION = "1.0.0" as const;
