/**
 * @generated from protocol/schemas/modules/crypto/v1.json
 * @version 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen
 * Zod validation schemas for the Crypto module
 */

import { z } from "zod";

/** Type of stored secret */
export const SecretTypeSchema = z.enum([
  "nostr_private_key",
  "master_key",
  "database_key",
  "api_token",
  "custom",
]);
export type SecretType = z.infer<typeof SecretTypeSchema>;

/** Asymmetric keypair for signing and encryption */
export const KeyPairSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Hex-encoded public key */
    publicKey: z.string(),
    /** Hex-encoded private key (sensitive, only present client-side) */
    privateKey: z.string().optional(),
  })
  .passthrough();
export type KeyPair = z.infer<typeof KeyPairSchema>;

/** AES-256-GCM encrypted data with nonce */
export const EncryptedDataSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Base64-encoded ciphertext */
    ciphertext: z.string(),
    /** Base64-encoded nonce/IV */
    nonce: z.string(),
  })
  .passthrough();
export type EncryptedData = z.infer<typeof EncryptedDataSchema>;

/** Double Ratchet message header for forward-secure messaging */
export const MessageHeaderSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Base64-encoded DH ratchet public key */
    dhPublicKey: z.string(),
    /** Number of messages in previous sending chain */
    previousChainLength: z.number().int(),
    /** Message number in current sending chain */
    messageNumber: z.number().int(),
  })
  .passthrough();
export type MessageHeader = z.infer<typeof MessageHeaderSchema>;

/** Result of unwrapping a NIP-17 gift-wrapped message */
export const UnwrapResultSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** Hex-encoded sender public key */
    senderPubkey: z.string(),
    /** Whether the seal signature was verified */
    sealVerified: z.boolean(),
  })
  .passthrough();
export type UnwrapResult = z.infer<typeof UnwrapResultSchema>;

/** A secret stored in the platform keyring */
export const StoredSecretSchema = z
  .object({
    _v: z.string().default("1.0.0"),
    /** The secret value */
    value: z.string(),
    secretType: SecretTypeSchema,
    /** Unix timestamp when stored */
    createdAt: z.number().int(),
    /** Unix timestamp when last accessed */
    lastAccessed: z.union([z.number().int(), z.null()]).optional(),
    /** Human-readable label */
    label: z.union([z.string(), z.null()]).optional(),
  })
  .passthrough();
export type StoredSecret = z.infer<typeof StoredSecretSchema>;

/** Module version */
export const CRYPTO_SCHEMA_VERSION = "1.0.0" as const;
