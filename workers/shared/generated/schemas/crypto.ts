/**
 * @generated from protocol/schemas/core/crypto/v1.json
 * @version 1.0.0
 * @minReaderVersion 1.0.0
 *
 * DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype
 */

// Version constants
export const CRYPTO_VERSION = "1.0.0";
export const CRYPTO_MIN_READER_VERSION = "1.0.0";

/**
 * Asymmetric keypair for signing and encryption
 */
export interface KeyPair {
  _v: string;
  /**
   * Hex-encoded private key (sensitive, only present client-side)
   */
  privateKey?: string;
  /**
   * Hex-encoded public key
   */
  publicKey: string;
  [property: string]: any;
}

/**
 * AES-256-GCM encrypted data with nonce
 */
export interface EncryptedData {
  _v: string;
  /**
   * Base64-encoded ciphertext
   */
  ciphertext: string;
  /**
   * Base64-encoded nonce/IV
   */
  nonce: string;
  [property: string]: any;
}

/**
 * Double Ratchet message header for forward-secure messaging
 */
export interface MessageHeader {
  _v: string;
  /**
   * Base64-encoded DH ratchet public key
   */
  dhPublicKey: string;
  /**
   * Message number in current sending chain
   */
  messageNumber: number;
  /**
   * Number of messages in previous sending chain
   */
  previousChainLength: number;
  [property: string]: any;
}

/**
 * Result of unwrapping a NIP-17 gift-wrapped message
 */
export interface UnwrapResult {
  _v: string;
  /**
   * Whether the seal signature was verified
   */
  sealVerified: boolean;
  /**
   * Hex-encoded sender public key
   */
  senderPubkey: string;
  [property: string]: any;
}

/**
 * A secret stored in the platform keyring
 */
export interface StoredSecret {
  _v: string;
  /**
   * Unix timestamp when stored
   */
  createdAt: number;
  /**
   * Human-readable label
   */
  label?: null | string;
  /**
   * Unix timestamp when last accessed
   */
  lastAccessed?: number | null;
  secretType: SecretType;
  /**
   * The secret value
   */
  value: string;
  [property: string]: any;
}

/**
 * Type of stored secret
 */
export enum SecretType {
  APIToken = "api_token",
  Custom = "custom",
  DatabaseKey = "database_key",
  MasterKey = "master_key",
  NostrPrivateKey = "nostr_private_key",
}
