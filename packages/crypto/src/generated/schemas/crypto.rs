//! Crypto module schema types
//!
//! @generated from protocol/schemas/core/crypto/v1.json
//! Version: 1.0.0
//! Min Reader Version: 1.0.0
//!
//! DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype

use serde::{Deserialize, Serialize};

/// Schema version for Crypto module
pub const CRYPTO_VERSION: &str = "1.0.0";
/// Minimum reader version for Crypto module
pub const CRYPTO_MIN_READER_VERSION: &str = "1.0.0";

/// Asymmetric keypair for signing and encryption
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct KeyPair {
    #[serde(rename = "_v")]
    pub v: String,

    /// Hex-encoded private key (sensitive, only present client-side)
    pub private_key: Option<String>,

    /// Hex-encoded public key
    pub public_key: String,
}

/// AES-256-GCM encrypted data with nonce
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
pub struct EncryptedData {
    #[serde(rename = "_v")]
    pub v: String,

    /// Base64-encoded ciphertext
    pub ciphertext: String,

    /// Base64-encoded nonce/IV
    pub nonce: String,
}

/// Double Ratchet message header for forward-secure messaging
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct MessageHeader {
    #[serde(rename = "_v")]
    pub v: String,

    /// Base64-encoded DH ratchet public key
    pub dh_public_key: String,

    /// Message number in current sending chain
    pub message_number: i64,

    /// Number of messages in previous sending chain
    pub previous_chain_length: i64,
}

/// Result of unwrapping a NIP-17 gift-wrapped message
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct UnwrapResult {
    #[serde(rename = "_v")]
    pub v: String,

    /// Whether the seal signature was verified
    pub seal_verified: bool,

    /// Hex-encoded sender public key
    pub sender_pubkey: String,
}

/// A secret stored in the platform keyring
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct StoredSecret {
    #[serde(rename = "_v")]
    pub v: String,

    /// Unix timestamp when stored
    pub created_at: i64,

    /// Human-readable label
    pub label: Option<String>,

    /// Unix timestamp when last accessed
    pub last_accessed: Option<i64>,

    pub secret_type: SecretType,

    /// The secret value
    pub value: String,
}

/// Type of stored secret
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum SecretType {
    #[serde(rename = "api_token")]
    ApiToken,

    Custom,

    #[serde(rename = "database_key")]
    DatabaseKey,

    #[serde(rename = "master_key")]
    MasterKey,

    #[serde(rename = "nostr_private_key")]
    NostrPrivateKey,
}

