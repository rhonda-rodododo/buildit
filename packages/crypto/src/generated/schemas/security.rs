//! Security module schema types
//!
//! @generated from protocol/schemas/core/security/v1.json
//! Version: 1.0.0
//! Min Reader Version: 1.0.0
//!
//! DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype

use serde::{Deserialize, Serialize};

/// Schema version for Security module
pub const SECURITY_VERSION: &str = "1.0.0";
/// Minimum reader version for Security module
pub const SECURITY_MIN_READER_VERSION: &str = "1.0.0";

/// A decoy identity shown under duress
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DecoyIdentity {
    #[serde(rename = "_v")]
    pub v: String,

    /// Bio/about text for the decoy
    pub about: String,

    /// Unix timestamp when created
    pub created_at: i64,

    /// Display name for the decoy identity
    pub display_name: String,
}

/// Result of checking whether a password is a duress password
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DuressCheckResult {
    #[serde(rename = "_v")]
    pub v: String,

    /// Whether the duress password was used
    pub is_duress: bool,

    /// Whether any valid password was entered
    pub password_valid: bool,
}

/// Configuration for alerts sent when duress is detected
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DuressAlertConfig {
    #[serde(rename = "_v")]
    pub v: String,

    /// Optional custom alert message
    pub custom_message: Option<String>,

    /// Whether to include GPS location in alert
    pub include_location: bool,

    /// Public keys of trusted contacts to alert
    pub trusted_contact_pubkeys: Vec<String>,
}

/// A fake contact shown in the decoy identity's contact list
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DecoyContact {
    #[serde(rename = "_v")]
    pub v: String,

    /// Display name of the decoy contact
    pub display_name: String,

    /// Public key of the decoy contact
    pub pubkey: String,
}

