//! Messaging module schema types
//!
//! @generated from protocol/schemas/modules/messaging/v1.json
//! Version: 1.0.0
//! Min Reader Version: 1.0.0
//!
//! DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype

use serde::{Deserialize, Serialize};

/// Schema version for Messaging module
pub const MESSAGING_VERSION: &str = "1.0.0";
/// Minimum reader version for Messaging module
pub const MESSAGING_MIN_READER_VERSION: &str = "1.0.0";

/// Direct message content (sent via NIP-17 gift wrap)
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DirectMessage {
    /// Schema version
    #[serde(rename = "_v")]
    pub v: String,

    pub attachments: Option<Vec<DirectMessageAttachment>>,

    /// Message text content
    pub content: String,

    /// Signal-style encrypted link previews
    pub link_previews: Option<Vec<DirectMessageLinkPreview>>,

    /// Pubkeys of mentioned users
    pub mentions: Option<Vec<String>>,

    /// ID of message being replied to
    pub reply_to: Option<String>,
}

/// Media attachment
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DirectMessageAttachment {
    /// BlurHash placeholder for images
    pub blurhash: Option<String>,

    pub dimensions: Option<PurpleDimensions>,

    /// Duration in seconds (audio/video)
    pub duration: Option<f64>,

    pub mime_type: Option<String>,

    /// Filename
    pub name: Option<String>,

    /// Size in bytes
    pub size: Option<i64>,

    /// Thumbnail URL for video
    pub thumbnail: Option<String>,

    #[serde(rename = "type")]
    pub attachment_type: Type,

    /// Content URL or data URL
    pub url: String,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum Type {
    Audio,

    File,

    Image,

    Video,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
pub struct PurpleDimensions {
    pub height: Option<i64>,

    pub width: Option<i64>,
}

/// Privacy-preserving link preview (Signal-style). Sender fetches OG metadata + thumbnail,
/// encrypts with content. Recipients see static previews — zero third-party requests.
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DirectMessageLinkPreview {
    /// Open Graph og:description
    pub description: Option<String>,

    /// Base64-encoded favicon (max ~10KB)
    pub favicon_data: Option<String>,

    /// Favicon MIME type
    pub favicon_type: Option<String>,

    /// Unix timestamp when preview was generated
    pub fetched_at: i64,

    /// Who fetched the preview — sender (direct) or proxy (API worker)
    pub fetched_by: FetchedBy,

    /// Base64-encoded thumbnail (max ~50KB, encrypted with content)
    pub image_data: Option<String>,

    /// Image height in pixels
    pub image_height: Option<i64>,

    /// MIME type (image/jpeg, image/png, image/webp)
    pub image_type: Option<String>,

    /// Image width in pixels
    pub image_width: Option<i64>,

    /// Open Graph og:site_name
    pub site_name: Option<String>,

    /// Open Graph og:title
    pub title: Option<String>,

    /// Original URL
    pub url: String,
}

/// Who fetched the preview — sender (direct) or proxy (API worker)
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum FetchedBy {
    Proxy,

    Sender,
}

/// Group message content
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct GroupMessage {
    #[serde(rename = "_v")]
    pub v: String,

    pub attachments: Option<Vec<GroupMessageAttachment>>,

    pub content: String,

    /// Target group identifier
    pub group_id: String,

    /// Signal-style encrypted link previews
    pub link_previews: Option<Vec<GroupMessageLinkPreview>>,

    pub mentions: Option<Vec<String>>,

    pub reply_to: Option<String>,

    /// Thread within group (optional)
    pub thread_id: Option<String>,
}

/// Media attachment
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct GroupMessageAttachment {
    /// BlurHash placeholder for images
    pub blurhash: Option<String>,

    pub dimensions: Option<FluffyDimensions>,

    /// Duration in seconds (audio/video)
    pub duration: Option<f64>,

    pub mime_type: Option<String>,

    /// Filename
    pub name: Option<String>,

    /// Size in bytes
    pub size: Option<i64>,

    /// Thumbnail URL for video
    pub thumbnail: Option<String>,

    #[serde(rename = "type")]
    pub attachment_type: Type,

    /// Content URL or data URL
    pub url: String,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
pub struct FluffyDimensions {
    pub height: Option<i64>,

    pub width: Option<i64>,
}

/// Privacy-preserving link preview (Signal-style). Sender fetches OG metadata + thumbnail,
/// encrypts with content. Recipients see static previews — zero third-party requests.
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct GroupMessageLinkPreview {
    /// Open Graph og:description
    pub description: Option<String>,

    /// Base64-encoded favicon (max ~10KB)
    pub favicon_data: Option<String>,

    /// Favicon MIME type
    pub favicon_type: Option<String>,

    /// Unix timestamp when preview was generated
    pub fetched_at: i64,

    /// Who fetched the preview — sender (direct) or proxy (API worker)
    pub fetched_by: FetchedBy,

    /// Base64-encoded thumbnail (max ~50KB, encrypted with content)
    pub image_data: Option<String>,

    /// Image height in pixels
    pub image_height: Option<i64>,

    /// MIME type (image/jpeg, image/png, image/webp)
    pub image_type: Option<String>,

    /// Image width in pixels
    pub image_width: Option<i64>,

    /// Open Graph og:site_name
    pub site_name: Option<String>,

    /// Open Graph og:title
    pub title: Option<String>,

    /// Original URL
    pub url: String,
}

/// Media attachment
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct Attachment {
    /// BlurHash placeholder for images
    pub blurhash: Option<String>,

    pub dimensions: Option<AttachmentDimensions>,

    /// Duration in seconds (audio/video)
    pub duration: Option<f64>,

    pub mime_type: Option<String>,

    /// Filename
    pub name: Option<String>,

    /// Size in bytes
    pub size: Option<i64>,

    /// Thumbnail URL for video
    pub thumbnail: Option<String>,

    #[serde(rename = "type")]
    pub attachment_type: Type,

    /// Content URL or data URL
    pub url: String,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
pub struct AttachmentDimensions {
    pub height: Option<i64>,

    pub width: Option<i64>,
}

/// Reaction to a message
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct Reaction {
    #[serde(rename = "_v")]
    pub v: String,

    /// Emoji character or shortcode
    pub emoji: String,

    /// ID of message being reacted to
    pub target_id: String,
}

/// Read receipt for messages
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct ReadReceipt {
    #[serde(rename = "_v")]
    pub v: String,

    /// DM partner pubkey or group ID
    pub conversation_id: String,

    /// ID of last read message
    pub last_read: String,

    /// Unix timestamp
    pub read_at: Option<i64>,
}

/// Ephemeral typing indicator
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct TypingIndicator {
    #[serde(rename = "_v")]
    pub v: String,

    pub conversation_id: String,

    pub typing: bool,
}

