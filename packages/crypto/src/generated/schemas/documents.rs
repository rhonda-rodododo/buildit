//! Documents module schema types
//!
//! @generated from protocol/schemas/modules/documents/v1.json
//! Version: 1.0.0
//! Min Reader Version: 1.0.0
//!
//! DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype

use serde::{Deserialize, Serialize};

/// Schema version for Documents module
pub const DOCUMENTS_VERSION: &str = "1.0.0";
/// Minimum reader version for Documents module
pub const DOCUMENTS_MIN_READER_VERSION: &str = "1.0.0";

/// A document with content and metadata
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct Document {
    /// Schema version that created this content
    #[serde(rename = "_v")]
    pub v: String,

    pub attachments: Option<Vec<AttachmentElement>>,

    /// Document content (format depends on type)
    pub content: String,

    /// Creation timestamp (Unix seconds)
    pub created_at: i64,

    /// Creator's public key (hex)
    pub created_by: String,

    /// Pubkeys of users with edit permission
    pub editors: Option<Vec<String>>,

    /// Who can edit this document
    pub edit_permission: Option<EditPermission>,

    /// Associated group ID
    pub group_id: Option<String>,

    /// Unique document identifier
    pub id: String,

    /// Signal-style encrypted link previews for URLs in document
    pub link_previews: Option<Vec<LinkPreview>>,

    /// Parent document for hierarchical organization
    pub parent_id: Option<String>,

    /// Optional summary or excerpt
    pub summary: Option<String>,

    /// Document tags for categorization
    pub tags: Option<Vec<String>>,

    /// Document title
    pub title: String,

    /// Document content type
    #[serde(rename = "type")]
    pub document_type: DocumentType,

    /// Last update timestamp (Unix seconds)
    pub updated_at: Option<i64>,

    /// Last editor's public key
    pub updated_by: Option<String>,

    /// Document revision version
    pub version: Option<i64>,

    /// Who can view this document
    pub visibility: Option<Visibility>,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct AttachmentElement {
    pub mime_type: Option<String>,

    pub name: Option<String>,

    /// File size in bytes
    pub size: Option<i64>,

    #[serde(rename = "type")]
    pub attachment_type: AttachmentType,

    pub url: String,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum AttachmentType {
    File,

    Image,

    Link,
}

/// Document content type
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum DocumentType {
    Markdown,

    #[serde(rename = "plain_text")]
    PlainText,

    #[serde(rename = "rich_text")]
    RichText,
}

/// Who can edit this document
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum EditPermission {
    Editors,

    Group,

    Owner,

    Public,
}

/// Privacy-preserving link preview (Signal-style). Sender fetches OG metadata + thumbnail,
/// encrypts with content. Recipients see static previews — zero third-party requests.
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct LinkPreview {
    /// Open Graph og:description
    pub description: Option<String>,

    /// Base64-encoded favicon (max ~10KB)
    pub favicon_data: Option<String>,

    /// Favicon MIME type
    pub favicon_type: Option<String>,

    /// Unix timestamp when preview was generated
    pub fetched_at: i64,

    /// Who fetched the preview — sender (direct) or proxy (API worker)
    pub fetched_by: FetchedBy,

    /// Base64-encoded thumbnail (max ~50KB, encrypted with content)
    pub image_data: Option<String>,

    /// Image height in pixels
    pub image_height: Option<i64>,

    /// MIME type (image/jpeg, image/png, image/webp)
    pub image_type: Option<String>,

    /// Image width in pixels
    pub image_width: Option<i64>,

    /// Open Graph og:site_name
    pub site_name: Option<String>,

    /// Open Graph og:title
    pub title: Option<String>,

    /// Original URL
    pub url: String,
}

/// Who fetched the preview — sender (direct) or proxy (API worker)
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum FetchedBy {
    Proxy,

    Sender,
}

/// Who can view this document
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum Visibility {
    Group,

    Private,

    Public,
}

/// A revision history entry for a document
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct DocumentRevision {
    #[serde(rename = "_v")]
    pub v: String,

    /// Description of changes in this revision
    pub change_note: Option<String>,

    pub content: String,

    pub document_id: String,

    pub edited_at: i64,

    pub edited_by: String,

    pub version: i64,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct Attachment {
    pub mime_type: Option<String>,

    pub name: Option<String>,

    /// File size in bytes
    pub size: Option<i64>,

    #[serde(rename = "type")]
    pub attachment_type: AttachmentType,

    pub url: String,
}

