//! Wiki module schema types
//!
//! @generated from protocol/schemas/modules/wiki/v1.json
//! Version: 1.0.0
//! Min Reader Version: 1.0.0
//!
//! DO NOT EDIT - This file is auto-generated by tools/codegen using quicktype

use serde::{Deserialize, Serialize};

/// Schema version for Wiki module
pub const WIKI_VERSION: &str = "1.0.0";
/// Minimum reader version for Wiki module
pub const WIKI_MIN_READER_VERSION: &str = "1.0.0";

use std::collections::HashMap;

/// A wiki page in the knowledge base
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct WikiPage {
    /// Schema version for graceful degradation
    #[serde(rename = "_v")]
    pub v: String,

    /// Alternative slugs that redirect to this page
    pub aliases: Option<Vec<String>>,

    /// Unix timestamp when page was archived
    pub archived_at: Option<i64>,

    /// Category this page belongs to
    pub category_id: Option<String>,

    /// Page content in markdown
    pub content: String,

    /// All contributors to this page
    pub contributors: Option<Vec<String>>,

    /// Unix timestamp of creation
    pub created_at: i64,

    /// Public key of the original creator
    pub created_by: String,

    /// Unix timestamp for soft delete
    pub deleted_at: Option<i64>,

    /// Group this page belongs to
    pub group_id: String,

    /// Unique identifier for the page
    pub id: String,

    /// Public key of the last editor
    pub last_edited_by: Option<String>,

    /// Timestamp when page was locked
    pub locked_at: Option<i64>,

    /// User who has the page locked for editing
    pub locked_by: Option<String>,

    /// Custom metadata fields
    pub metadata: Option<HashMap<String, Option<serde_json::Value>>>,

    /// Parent page for hierarchical organization
    pub parent_id: Option<String>,

    pub permissions: Option<PermissionsClass>,

    /// Unix timestamp when page was published
    pub published_at: Option<i64>,

    /// URL-friendly identifier
    pub slug: String,

    pub status: PageStatus,

    /// Brief summary for search results and previews
    pub summary: Option<String>,

    /// Categorization tags
    pub tags: Option<Vec<String>>,

    /// Page title
    pub title: String,

    /// Unix timestamp of last update
    pub updated_at: Option<i64>,

    /// Current version number of the page
    pub version: i64,

    pub visibility: Option<PageVisibility>,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct PermissionsClass {
    pub allow_comments: Option<bool>,

    pub allow_suggestions: Option<bool>,

    /// Roles that can edit this page
    pub edit_roles: Option<Vec<String>>,

    /// Roles that can view this page (for role-restricted)
    pub view_roles: Option<Vec<String>>,
}

/// Current status of the page
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum PageStatus {
    Archived,

    Deleted,

    Draft,

    Published,

    Review,
}

/// Who can view this page
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "kebab-case")]
pub enum PageVisibility {
    Group,

    Private,

    Public,

    #[serde(rename = "role-restricted")]
    RoleRestricted,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct PagePermissions {
    pub allow_comments: Option<bool>,

    pub allow_suggestions: Option<bool>,

    /// Roles that can edit this page
    pub edit_roles: Option<Vec<String>>,

    /// Roles that can view this page (for role-restricted)
    pub view_roles: Option<Vec<String>>,
}

/// A historical revision of a wiki page
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct PageRevision {
    #[serde(rename = "_v")]
    pub v: String,

    pub content: String,

    pub created_at: i64,

    /// Unified diff from previous version
    pub diff: Option<String>,

    pub edited_by: String,

    pub edit_type: Option<EditType>,

    pub id: String,

    pub page_id: String,

    /// Version number if this is a revert
    pub reverted_from: Option<i64>,

    /// Edit summary describing the changes
    pub summary: Option<String>,

    pub title: Option<String>,

    pub version: i64,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum EditType {
    Create,

    Edit,

    Merge,

    Move,

    Revert,
}

/// A category for organizing wiki pages
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct WikiCategory {
    #[serde(rename = "_v")]
    pub v: String,

    /// Display color
    pub color: Option<String>,

    pub created_at: i64,

    pub created_by: String,

    pub description: Option<String>,

    pub group_id: String,

    /// Icon identifier
    pub icon: Option<String>,

    pub id: String,

    pub name: String,

    /// Display order
    pub order: Option<i64>,

    /// Number of pages in this category
    pub page_count: Option<i64>,

    /// Parent category for hierarchical organization
    pub parent_id: Option<String>,

    pub slug: String,

    pub updated_at: Option<i64>,
}

/// A link between wiki pages
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct WikiLink {
    #[serde(rename = "_v")]
    pub v: String,

    /// Text around the link for context
    pub context: Option<String>,

    pub created_at: i64,

    /// Whether target page exists
    pub is_broken: Option<bool>,

    pub source_page_id: String,

    pub target_page_id: Option<String>,

    /// Slug of target page (for broken link detection)
    pub target_slug: String,
}

/// A comment on a wiki page
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct PageComment {
    #[serde(rename = "_v")]
    pub v: String,

    pub author_id: String,

    pub content: String,

    pub created_at: i64,

    pub deleted_at: Option<i64>,

    pub edited_at: Option<i64>,

    pub id: String,

    pub page_id: String,

    /// Parent comment for threaded replies
    pub parent_id: Option<String>,

    /// Whether this comment thread is resolved
    pub resolved: Option<bool>,

    pub resolved_at: Option<i64>,

    pub resolved_by: Option<String>,
}

/// A suggested edit to a wiki page
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct EditSuggestion {
    #[serde(rename = "_v")]
    pub v: String,

    /// Version this suggestion is based on
    pub base_version: i64,

    /// Suggested content
    pub content: String,

    pub created_at: i64,

    /// Unified diff showing changes
    pub diff: Option<String>,

    pub id: String,

    pub page_id: String,

    pub review_comment: Option<String>,

    pub reviewed_at: Option<i64>,

    pub reviewed_by: Option<String>,

    pub status: Status,

    pub suggested_by: String,

    /// Description of the suggested changes
    pub summary: Option<String>,

    /// Suggested title (if changed)
    pub title: Option<String>,
}

#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum Status {
    Approved,

    Merged,

    Pending,

    Rejected,

    Superseded,
}

/// Search result from the wiki
#[derive(Debug, Clone, PartialEq, Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct WikiSearch {
    #[serde(rename = "_v")]
    pub v: String,

    pub category_name: Option<String>,

    /// Relevant excerpt with search terms highlighted
    pub excerpt: Option<String>,

    pub matched_tags: Option<Vec<String>>,

    pub page_id: String,

    /// Search relevance score
    pub score: f64,

    pub slug: String,

    pub summary: Option<String>,

    pub title: String,

    pub updated_at: Option<i64>,
}

